{%- extends 'files/guest.instances.inc.j2' -%}{%- block body -%}
#!/bin/bash

if [[ -f "{{ config_file }}" ]] ; then
  source "{{ config_file }}"
fi

{% if looking_glass == true %}
if [[ "x$BOOTSTRAP" != "x" ]]; then
  exec spicy --uri "spice+unix://{{ spice_socket }}"
else
  exec looking-glass-client -f "{{ looking_glass_file }}" -c "{{ spice_socket }}" -p 0 -o "opengl:amdPinnedMem=0" -a &
fi
{% elif video_hardware == 'none' %}
if [[ "x$BOOTSTRAP" != "x" ]]; then
  exec spicy --uri "spice+unix://{{ spice_socket }}"
else
  echo "ERROR: No video output available from the guest"
  exit 1
fi
{% else %}
exec spicy --uri "spice+unix://{{ spice_socket }}"
{% endif %}

{% endblock %}
